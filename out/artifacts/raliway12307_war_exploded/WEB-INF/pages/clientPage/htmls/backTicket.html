<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/ticket.css">
    <title>退票</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        #modify {
            width: 100%;
            height: 100%;
        }

        form {
            width: 20%;
            float: right;
            margin-right: 20px;
            border-radius: 10px;
        }
        #user-message .lan button:hover #modify path {
            stroke: #fff;
        }

        /* 信息栏 */
        #msg-lan{

            background-color: #48A19B;
            width: 100%;
            height: 260px;
            position: fixed;
            z-index: 99;
           
        }
        #msg-lan-img{
            width:100%;height: 220px;
            /* border-bottom: solid 1px #666; */
            background-image: url('http://images1.wenming.cn/web_wenming/images/rlqzxzgcl20210517-01.jpg');
            background-repeat: no-repeat;
            
            background-position: 0% 0%;
            background-size: cover;
        }
        #tickets-box{
            position: relative;
            border-radius: 5px;
            /* top:70px; */
            width: 80%;
            left: 10%;
            padding-left: 60px;
            border: solid 2px darkslateblue;
        }
   
/* 确认退票面板 */
        #sureto-back-tickte{
            position: relative;
            width: 400px;
            height: 450px;
            z-index: 10;
            background-color: #fff;
            border: solid 2px #333;
            box-shadow: 0 0 12px darkslateblue;
            display: none;
            left: 50%;
            height: 50%;
            transform: translateX(-50%) translateY(-50%);
            border-radius: 20px;
            
            transition: all 0.5s;
        }
        #sureto-back-tickte .box-two{
            padding: 20px;
            margin: 20px;
        }
        #sure2 h2{
            display: inline-block;
            width: 100px;
            /* background-color: #fff; */
            height: 40px;
            text-align: center;
            /* transform: translateY(-10px); */
            font-size: 18px;
        }
        #sure2 div{
            width: 80px;
            display: inline-block;
        }
        #sure2 div h5{
            /* display: block; */
            text-align: center;
            /* width: 40px; */
            margin-bottom: 0;
        }
        #sure2 div img{
            position: relative;
            width: 50px;height: 20px;background-color: slategray;
            left: 50%;
            transform: translateX(-50%);
        }
        #sureto-back-tickte .box-two p{
            font-size: 14px;
            margin-bottom: 10px;
        }
        #sure-6 input{
            position: relative;
            width: 100px;
            height: 30px;
            left: 50%;
            transform: translateX(-50%);
        }
        .close{
            float: right;
            transform: translateY(-30px);
        }
        .close input{
            width: 50px;
            height: 30px;
        }
        .inline-block-elem{
            display: inline-block;
            
        }
    </style>
</head>
<body>
    <div>
        <div id="back-tick-service" class="message-mine">
            
            <div id="msg-lan">
                <div id="msg-lan-img"></div>
                <div style="width: 100%;display: inline-block;">
                    
                    <p class="inline-block-elem" style="margin-left: 20px;">已购买火车票：</p>
                    <p  class="inline-block-elem" id="tickets-nums" style="font-size: 20px;margin-right: 10px;color: #fff;width: 10%;">16</p>
                    <p  class="inline-block-elem" style="font-size: 22px;width: 50%;text-align: center;">您已购买的火车票列表如下</p>
                    <!-- <select class="inline-block-elem" id="tickets-id-nums">
                        <option value="" style="color: #888" disabled selected>请选择一张火车票：</option>
                        <option value="1">1</option>
                        <option value="2">1</option>
                        <option value="3">1</option>
                        <option value="4">1</option>
                    </select> -->

                    <form action="modify.html" method="GET" class="inline-block-elem">
                        <input class="inline-block-elem" id="tickets-id-nums" type="text" style="visibility: hidden;width: 50%;">
                        <div class="inline-block-elem">
                            <input type="submit" class="modify-tickets-but back-tickets-but" id='modify-button' value="去改签"></input>
                        </div>
                    </form>

                    <!-- <input type="submit" class="back-tickets-but inline-block-elem" id='back-button' value="退票"></input> -->
                    <!-- <button id= "find-my-tickets" style="margin-left: 20px;" class="back-tickets-but inline-block-elem">刷新我的票</button> -->
                    <div id="sureto-back-tickte" >
                        <div class="box-two">
                            <div id="sure-1" >
                                <h3 style="font-size: 16px;">确认退票：G2312次？</h3>
                            </div>
                            <div  id="sure2">
                                <h2>上海虹桥</h2>
                                <div id="sure-21">
                                    <h5>发往</h5>
                                    <img src="">
                                </div>
                                <h2>南天门</h2>
                            </div>
                            <div id="sure-3">
                                <p>订单编号：5555555555555555</p>
                            </div>
                            <div id="sure-4">
                                <p>发车时间：2021年6月29日&nbsp;&nbsp;16:55:00</p>
                            </div>
                            <div id="sure-5">
                                <p>￥：456.00元</p>
                            </div>
                            <div id="sure-6">
                                <input type="button" id="sureto-back-bt" value="确认退票">
                            </div>
                            <div class="close">
                                <input type="button" id="close-bt" value="关闭">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 占位 -->
            <div style="width: 100%;height: 265px;" ></div>
            <!-- 退票/改签 -->
            <div id="tickets-box">
                <!-- <select>
                    <option>G2312</option>
                    <option>T2236</option>
                </select> -->
                <ul id="uls">
            
                   
                    <!-- <li class="inline-block-elem" value="11116" >
                        <div class="tickes" onmousedown="chiosed(this)">
                            <div class="tick-1">
                                 <div class="tick-11">
                                     <p style="color:rgb(209, 1, 1);font-size: 14px;" >123465846516456</p>
                                     <div class="tick-111">
                                         <h3 class="inline-block-elem">南昌西</h3>
                                         <div class="tick-1111 inline-block-elem">
                                             <h5>G2312</h5>
                                             <img src='#'>
                                         </div>
                                         <h3 class="inline-block-elem">北京南</h3>
                                     </div>
                                     <p >2021年6月13号&nbsp;&nbsp;16:45&nbsp;&nbsp;开</p>
                                     <div class="tick-112">
                                         <p class="tick-1121 inline-block-elem">￥45.5元</p>
                                         <p class="tick-1122 inline-block-elem">二等座</p>
                                     </div>
                                     <div class="tick-113 ">
                                         <p class="inline-block-elem">26354899951257841X&nbsp;&nbsp;张三</p>
                                         <img class="inline-block-elem" src=''>
                                     </div>
                                 </div>
                                 <div class="tick-12"></div>
                            </div>

                        </div>
                    </li> -->
                </ul>
            </div>
            <div></div>
        </div>
        
    </div>
    



<script src="./js/importJq/jquery-3.6.0.min.js"></script>
<script src="./js/managerJs/all.js"></script>
<script href="./js/managerJs/railwayOperator.js"></script>
<script type="text/javascript" src="http://cdn.staticfile.org/jquery/2.1.1-rc2/jquery.min.js"></script>

<script>
    var li_size=0;//记录车票数

    // 选中当前车票出现阴影，其他车票失去阴影
    function chiosed(elem){
        for(x =0;x<li_size;x++){
            document.querySelectorAll("#uls li .tickes")[x].style.cssText = "box-shadow:0;";
        }
        elem.style.cssText = "box-shadow:0 0 18px darkslateblue ;";
    }
        //传入数值，生成车票列表
        //火车票对应的账单号
        //火车票的始发站
        //火车对应的编号
        //到达站
        //发车时间
        //票价
        //座位类型
        //用户身份证
        //用户姓名
        add_list();



        var back_panel=document.getElementById("sureto-back-tickte");
        $("#find-my-tickets").click(add_list);

        $('#modify-button').click(function () {
            // alert("签票");
            // alert("value:"+document.querySelector('#tickets-id-nums').value);
            document.querySelector("input[type='text']").value=document.querySelector('#tickets-id-nums').value;
            alert("value:"+document.querySelector("input[type='text']").value);

        });
        $('#back-button').click(function () {
            back_panel.style.display="block";
        });
        $("#tickets-id-nums").mouseenter(function(){
            // alert("value:"+document.querySelector('#tickets-id-nums').value);
            document.querySelector("input[type='text']").value=document.querySelector('#tickets-id-nums').value;
        });
        $("#tickets-id-nums").mousedown(function(){

        });
        //关闭退票提示
        $("#close-bt").click(function(){
            back_panel.style.display="none";
        });

        // 确认退票
        $("#sureto-back-bt").click(function(){
         // alert("退票");
            // alert("value:"+document.querySelector('#tickets-id-nums').value);
            document.querySelector("input[type='text']").value=document.querySelector('#tickets-id-nums').value;
            alert("订单编号为:"+document.querySelector("input[type='text']").value+"退票成功，交易完成！");

        });

        $("#tickets-box").mouseenter(function(){
            // alert("value:"+document.querySelector('#tickets-id-nums').value);
            // document.querySelector("input[type='text']").value=document.querySelector('#tickets-id-nums').value;
        
        });

        // 清除元素子节点
        function delete_select(id){
            var e = document.querySelector(id);
            var first = e.firstElementChild;
            while (first) {
                first.remove();
                first = e.firstElementChild;
                // sleep(100);
            } 
        }

        

        function set_selected(str){
            // var obj = document.getElementById("tickets-id-nums");
            // for(i=0;i<obj.length;i++){
            //     if(obj[i].value==str)
            //         obj[i].selected = true;
            // }
        }


        function sleep(numberMillis) {
            var now = new Date();
            var exitTime = now.getTime() + numberMillis;
                while (true) {
                now = new Date();
                if (now.getTime() > exitTime){
                    return;
                }
            }

        }

        //单击退票按钮时
        function backTicks(str){
            // alert("111");
            back_panel.style.display="block";
            // document.querySelector("input[type='text']").value=document.querySelector('#tickets-id-nums').value;
            // alert("订单编号为:"+document.querySelector("input[type='text']").value+"退票成功，交易完成！");
        }
         //单击改签按钮时
        function modifyTicks(str){
            alert("222");
        } 
        // 选中对应的车票后，记录当前选择的票
        function add_action(str){
                // set_selected(str);
                document.querySelector('#tickets-id-nums').value=str;
            }
        function add_list(){
            var uls=$("#tickets-box ul");
            delete_select("#tickets-id-nums");
            delete_select("#tickets-box ul");
            
            li_size=0;
            for(i=0;i<20;i++){
                
                var v0="123465846516456"+i;//火车票对应的账单号
                var v1="南昌西";//火车票的始发站
                var v2="G2312";//火车对应的编号
                var v3="北京南";//到达站
                var v4="2021年6月13号  12:36:00";//发车时间
                var v5="45.5";//票价
                var v6="二等座";//座位类型
                var v7="26354899951257841X";//用户身份证
                var v8="张三";//用户姓名
                var v9='不失效';
                if(v9 != '失效'){
                    v9="style='display:none;'";
                }
                else{
                    v9='';
                }
                $('#tickets-id-nums').append("<option value= " + 
                                                v0 + ">" + 
                                                v0 + "</option>");
                // $("#tickets-box ul").append("<li class='inline-block-elem' value="+
                //                             v0+"  onmousemove=add_action("+
                //                             v0+")><div class='tickes'><div class='is-shixiao' "+
                //                             v9+"><p>已失效</p></div><div class='tick-1'><div class='tick-11'<p style='color:rgb(209, 1, 1);font-size: 14px;' >"+
                //                             v0+"</p><div class='tick-111'><h3 class='inline-block-elem'>"+
                //                             v1+"</h3><div class='tick-1111 inline-block-elem'><h5>"+
                //                             v2+"</h5><img src='#'></div><h3 class='inline-block-elem'>"+
                //                             v3+"</h3></div><p >"+
                //                             v4+"&nbsp;&nbsp;16:45&nbsp;&nbsp;开</p><div class='tick-112'><p class='tick-1121 inline-block-elem'>￥"+
                //                             v5+"元</p><p class='tick-1122 inline-block-elem'>"+
                //                             v6+"</p></div><div class='tick-113 '><p class='inline-block-elem'>"+
                //                             v7+"&nbsp;&nbsp;"+
                //                             v8+"</p><img class='inline-block-elem' src=''></div></div><div class='tick-12'></div></div><button id='back-button' onclick=backTicks("+
                //                             v0+")>退票</button><button id='modify-button' onclick=modifyTicks("+
                //                             v0+")>改签</button></div></li>"); 
                $("#tickets-box ul").append("<li class='inline-block-elem' value="+
                    v0+"  onmousemove=add_action("+
                    v0+")><div class='tickes' onmousedown='chiosed(this)'><div class='tick-1'><div class='tick-11'><p class='id-warter' >"+
                    v0+"</p><div class='tick-111'><h3 class='inline-block-elem tick-111-sub'>"+
                    v1+"</h3><div class='tick-1111 inline-block-elem tick-111-sub'><h5 style='text-align: center;'>"+
                    v2+"</h5><img src='img/icon_go.png' ></div><h3 class='inline-block-elem tick-111-sub'>"+
                    v3+"</h3></div><p class='tick-1121'>"+
                    v4+"&nbsp;&nbsp;开</p><div class='tick-112'><p class='tick-1121 inline-block-elem'>"+
                    v5+"元</p><p class='tick-1122 inline-block-elem'>"+
                    v6+"</p></div><div class='tick-113 '><p class='tick-1121 inline-block-elem'>"+
                    v7+"&nbsp;&nbsp;"+
                    v8+"</p><img class='inline-block-elem' src=''></div></div><div class='tick-12'><button id='back-button' onclick=backTicks("+
                    v0+")>退票</button><button id='modify-button' onclick=modifyTicks("+
                    v0+")>改签</button></div><div class='is-shixiao' "+
                    v9+"><p>已失效</p></div></div><p class='make-msg'>铁路12306&nbsp;&nbsp;制</p></div></li>"); 
                li_size=li_size+1;
            }
        }
        </script>
    </body>
</html>