<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>买票</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }

        /* 左盒子 */
        #left-panel{
            float: left;
            width: 10%;
            height: 730px;
            background-color: teal;
        }

        /* 右盒子 */
        #right-panel{
            float: right;
            width: 90%;
            height: 730px;
            /* background-color: rgb(142, 70, 209); */
        }
        /* 输入内容的盒子 */
        #input-bar{
            width: 100%;
            height: 25%;
            background-color: brown;
        }

        /* 设置表格样式 */
        #ticket-table #tab{
            width: 96%;
            margin: 2%;
            border: solid 1px #666;
            font-size: 16px;
            padding: 10px;
        }
        #ticket-table tr{
            text-align: center;
        }
        #ticket-table th{
            border-bottom: solid 2px #333;
            width: 100px;
            height: 50px;
        }
        #ticket-table td{
            border-bottom: solid 1px #666;
            width: 100px;
            height: 50px;
        }
        #ticket-table .exe-td{
            width: 220px;
            height: 50px;
        }

        /* 设置输入框区域样式 */
        #bottom-inputarea{
            /* float: left; */
            width: 100%;
            height: 20%;
            padding: 20px;
        }
        #bottom-inputarea input{
            width: 80%;
            height: 70%;
            transform: translateX(10px);
        }
        #bottom-inputarea p{
            color: #fff;
            font-size: 14px;
        }
        #bottom-inputarea div{
            margin-top: 10px;
            width: 20%;
            height: 100%;
            display: inline-block;
        }
        /* 输入区上侧图片 */
        #top-imgarea{
            float: right;
            width: 100%;
            height: 60%;
            background-color: cadetblue;
            background-image: url('img/1624584759662518.jpg');
            background-size: cover;
        }
        /* 设置侧边栏样式 */
        #left-panel #img{
            width:100px;
            height:100px;
            margin: 20px;
            border-radius: 50px;
            background-color: brown;
        }
        #left-panel p{
            font-size: 12px;
            margin: 20px 10px 20px 10px;
            border-bottom: solid 1px #fff;
        }
        #left-panel #name{
            font-size: 24px;
        }

        /* 设置下单面板的样式 */
        #pick-message{
            display: none;
            position: relative;
            width:800px;
            height: 500px;
            background-color: #fff;
            left: 50%;
            transform: translateX(-50%);
            border:solid 2px #333;
            border-radius: 10px;
            box-shadow: 0 0 12px darkslateblue;
        }
        #pick-message .sub-box{
            margin: 20px;
        }
        #pick-message p{
            font-size: 18px;
        }
        #pick-message li{
            list-style: none;
            font-size: 18px;
        }
        #pick-message .ticks-panel{
            display: inline;
        }
        #pick-message .pick-top{
            display: inline-block;
        }

        /* 关闭按钮 */
        #close{
            width: 30px;
            height: 30px;
            border-radius: 15px;
            float:right;
            margin: 20px 20px auto auto;
        }

        /* 为关闭按钮添加旋转时间 */
        #close:hover {
            animation-timing-function:ease;
            animation-name: roateClose;
            animation-duration: 0.5s;
        }
        #close svg{
            width: 90%;
            height: 90%;
            transform: translateX(2px) translateY(2px);
        }
        @keyframes roateClose{
            0%{
                
            }
            50%{
                transform: rotateZ(90deg);
            }
            100%{
                transform: rotateZ(-90deg);
            }
        }
        /* 用户信息 */
        #u-msg{
            width: 100%;
            height: 40%;
            /* background-color: darkgreen; */
            border-bottom: solid 1px #666;
        }
        #u-msg .u-msg-box{
            width: 40%;
            top:30px;
            transform: translateY(-10%);
        }
        #u-msg .u-msg-box p{
            margin: 20px 0 10px 0;
            font:bold;
            border-bottom: solid 1px #666;
        }
        #u-img{
            margin: 30px;
            width: 120px;
            height: 120px;
            background-color: crimson;
        }
        /* 票单信息 */
        #ticket-msg{
            /* background-color: rgb(102, 59, 59); */
            width: 100%;
            height: 200px;
        }
        #ticket-msg .pt-1{
            padding: 20px;
        }
        #ticket-msg .pt1-1{
            width: 20%;
        }
        #ticket-msg .pt1-2{
            width: 60%;
        }
        #ticket-msg .pt-1 li{
            padding: 5px;
            border-bottom: solid 1px #aaa;
            text-align: center;
        }

        #ticket-msg .pt-1 li div{
           width: 100%;
           height: 100%;
        }
        #ticket-msg .pt-1 li div .li-left{
            margin-left: 20px;
            margin-right: 50px;
            /* float: left; */
        }
        #ticket-msg .pt-1 li div .li-right{
            margin-right: 20px;
            margin-left: 50px;
            /* float: right; */
        }

        /* 下单按钮 */
        #buy-ticket{
            width: 100px;
            height: 30px;
            float: right;
            border: solid 1px darkslateblue;
            margin-right: 90px;
        }
        #buy-ticket:hover{
            transition: 0.3s;
            background-color: darkslateblue;
            color: #fff;
            box-shadow: 0 0 10px darkslateblue;
        }

        /* //时间样式 */
        #show_time{
            font-size: 28px;
            color: #fff;
            /* position: relative; */
            margin:65px auto 10px 30px;
        }
    </style>
</head>
<body>
    <div id="left-panel">
        <div id="img"></div>
        <p id="name">海子哥</p>
        <p id="gexingqianmi">个性签名：这个人什么都没有写</p>
        <p id="user-type">我是：学生</p>
        <p id="phone">phone：15770674965</p>
        <p id="email">邮箱：2749984520@qq.com</p>
        <p id="ic">海子哥</p>

       
    </div>
    <div id="right-panel" style="overflow: auto;">
        <div id="input-bar">
            <div id="top-imgarea" >
                 <!-- //显示当前时间 -->
                 <div id="show_time" >
                    <script>
                        setInterval("show_time.innerHTML=new Date().toLocaleString()+' 星期'+'日一二三四五六'.charAt(new Date().getDay());",1000);  
                    </script>
                </div>
                <!-- <img src="" alt=""> -->
            </div>
            <div id="bottom-inputarea">
                <div>
                    <p>输入出发地区（省/市/区）：</p>
                    <input type="text" placeholder="从哪出发？" id="start-area" >
                </div>
                
                <div>
                    <p>输入目的地（省/市/区）：</p>
                    <input type="text" placeholder="到哪里去？" id="end-area">
                </div>
            
                <div>
                    <p>选择出发日期：</p>
                    <input type="date" id="start-time">
                </div>
                <button style="width: 100px;height: 30px;" onclick="find_ticks()">确定</button>
            </div>
        </div>
        <div id="ticket-table" >
            <div id="pick-message" style="position: fixed;z-index: 99;">
                <div class="sub-box">
                    <div id="close" onclick="close_ticketpanel()">
                        <svg t="1624727498413" class="icon" viewBox="0 0 1051 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2373" width="48" height="48">
                            <path d="M656.412 507.821l300.087-292.172a92.077 92.077 0 0 0 0-132.76 98.221 98.221 0 0 0-136.358 0L520.026 375.005 219.994 82.89a98.221 98.221 0 0 0-136.386 0 92.077 92.077 0 0 0 0 132.76l300.088 292.17L83.58 799.993a92.077 92.077 0 0 0 0 132.76c18.072 17.602 42.62 27.538 68.192 27.455 25.573 0 50.093-9.853 68.193-27.455l300.06-292.172 300.087 292.172c18.045 17.602 42.593 27.538 68.165 27.455 25.573 0 50.121-9.853 68.193-27.455a92.077 92.077 0 0 0 0-132.76L656.41 507.821z" p-id="2374" fill="#d81e06">
                            </path>
                        </svg>
                    </div>
                    <div id="u-msg" class="ticks-panel pick-top">
                        <div id="u-img" class="pick-top"></div>
                        <div class="pick-top u-msg-box" >
                            <p id="u-name">肖家海</p>
                            <p id="u-type">VIP</p>
                            <p id="u-ic">36240000000815481X</p>
                            <p id="u-pho">15770674965</p>
                        </div>
                    </div>
                    <div id="ticket-msg" >
                        <div class="pick-top pt-1 pt1-1">
                            <ul>
                                <li>车次</li>
                                <li>发车/到站</li>
                                <li>发车时间</li>
                                <li>选座</li>
                                <li>应付金额</li>
                            </ul>
                        </div>
                        <div class="pick-top pt-1 pt1-2">
                            <ul id="tic-msgs ">
                                <li>
                                    <p id="ticket-train-id">G2312</p>
                                </li>
                                <li>
                                    <div>
                                        <p id="s-station" class="li-left" style="display: inline;">南昌站</p>
                                        <p id="e-station" class="li-right"style="display: inline;">上海虹桥</p>
                                    </div>
                                </li>
                                <li>
                                    <div>
                                        <p id="s-time" class="li-left" style="font-size: 12px;display: inline;">2020-6-30&nbsp;&nbsp;6:12:52</p>
                                        <p id="e-time" class="li-right" style="font-size: 12px;display: inline;">2020-6-30&nbsp;&nbsp;13:00:52</p>
                                    </div>
                                </li>
                                <li>
                                    <select id="seat-type" style="width: 200px;height: 30px;">
                                        <option value="1">一等座</option>
                                        <option value="2">二等座</option>
                                        <option value="3">硬卧</option>
                                        <option value="4">硬座</option>
                                        <option value="5">无座</option>
                                    </select>
                                </li>
                                <li>
                                    <p id="money">￥562.00元</p>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <input type="button" id="buy-ticket" value="立即下单">
                </div>
            </div>
            <table id="tab">
                <tr>
                    <th>车次</th>
                    <th class="exe-td">起点站</th>
                    <th class="exe-td">到达站</th>
                    <th>商务座</th>
                    <th>软卧</th>
                    <th>硬卧</th>
                    <th>一等座</th>
                    <th>二等座</th>
                    <th>硬座</th>
                    <th>无座</th>
                    <th>备注</th>
                </tr>
                <!-- <tr>
                    <td>G2312</td>
                    <td class="exe-td">
                        <div>
                            <p >南昌西</p>
                            <p >2020-7-1&nbsp;&nbsp;6:12:00</p>
                        </div>
                    </td>
                    <td class="exe-td">
                        <div>
                            <p >上海虹桥</p>
                            <p >2020-7-1&nbsp;&nbsp;10:12:00</p>
                        </div>
                    </td>
                    <td>12</td>
                    <td>56</td>
                    <td>无</td>
                    <td>无</td>
                    <td>无</td>
                    <td>85</td>
                    <td>10</td>
                    <td>
                        <a href="#">去购买</a>
                    </td>
                </tr> -->
            </table>
        </div>
    </div>

    <script src="./js/importJq/jquery-3.6.0.min.js"></script>
    <script src="./js/managerJs/all.js"></script>
    <script href="./js/managerJs/railwayOperator.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/jquery/2.1.1-rc2/jquery.min.js"></script>
    <script>

        
        // 更新用户内容
        setUser();
// 单击关闭按钮，关闭下单面板document.getElementById("close").onclick();
        function close_ticketpanel(){
            document.querySelector("#pick-message").style.display="none";
        }

        function add(){
            for(i=0;i<20;i++){
                add_table(i);
            }
        }
        // alert("123");
        // delete_table("tab");
        // 获取表格元素
        var table=$('#ticket-table table');

        // 获取输入内容的元素
        var startArea=document.getElementById("start-area");
        var endArea=document.getElementById("end-area");
        var startTime=document.getElementById("start-time");

        //鼠标从出发地的输入框离开后进行异步操作，模糊查询输入城市是否存在数据库
        // $("#start-area").onblur(function(){
            // delete_table("tab");
        // });

         //鼠标从目的站的输入框离开后进行异步操作，模糊查询输入城市是否存在数据库
        // $("#end-area").onblur(function(){
            // 
        // });
         //鼠标从时间输入框离开后进行异步操作，查询时间是否选择合理
        // startArea.onblur(function(){
            
        // });


        // 获取侧边栏元素
        var img=document.getElementById("img");
        var uname=document.getElementById("name");
        var gexingqianmi=document.getElementById("gexingqianmi");
        var userType=document.getElementById("user-type");
        var phone=document.getElementById("phone");
        var email=document.getElementById("email");

        // 更新用户内容
        function setUser(){
            var v0="https://avatar.csdnimg.cn/6/3/7/0_qq_44140450_1620910175.jpg";
            var v1="肖家海";
            var v2="没有";
            var v3="VIP";
            var v4="19970246857";
            var v5="2749984520@qq.com";
            var v6="36243019******481X"
            document.getElementById("img").style.background="url("+v0+") no-repeat";
            document.getElementById("img").style.backgroundSize="100px";
            document.getElementById("name").innerHTML=v1;
            document.getElementById("gexingqianmi").innerHTML="个性签名："+v2;
            document.getElementById("user-type").innerHTML="我是："+v3;
            document.getElementById("phone").innerHTML="phone："+v4;
            document.getElementById("email").innerHTML="邮箱："+v5;
            document.getElementById("ic").innerHTML="身份证："+v6;

            document.getElementById("u-img").style.background="url("+v0+") no-repeat";
            document.getElementById("u-img").style.backgroundSize="100px";
            document.getElementById("u-name").innerHTML=v1;
            document.getElementById("u-type").innerHTML=v3;
            document.getElementById("u-pho").innerHTML=v4;
            document.getElementById("u-ic").innerHTML=v6;
        }

        // 删除表格中的元素
        function delete_table(table_id){
            var tab=document.getElementById(table_id);
            var len=tab.rows.length;
            for(i=len-1;i >0; i--){
                tab.deleteRow(i);
            }
        }

        // 动态向表格中添加一行元素
        function add_table(index){
            var v0="G2314";
            var v1="南昌西";
            var v2="2020-7-1 6:12:00";
            var v3="上海虹桥";
            var v4=" 2020-7-1 10:12:00";
            var v5="20";
            var v6="56";
            var v7="无";
            var v8="无";
            var v9="无";
            var v10="85";
            var v11="10";
            var v12="去购买";
            var tab="tab";
            $("#tab").append("<tr><td>"+
                v0+"</td><td class='exe-td'><div><p >"+
                v1+"</p><p >"+
                v2+"</p></div></td><td class='exe-td'><div><p >"+
                v3+"</p><p >"+
                v4+"</p></div></td><td>"+
                v5+"</td><td>"+
                v6+"</td><td>"+
                v7+"</td><td>"+
                v8+"</td><td>"+
                v9+"</td><td>"+
                v10+"</td><td>"+
                v11+"</td><td><a href='#' onclick='click_a("+index+")'>"+
                v12+"</a></td></tr>"); 
        }
// delete_table("+tab+")
        var startArea=document.getElementById("start-area");
        var endArea=document.getElementById("end-area");
        var startTime=document.getElementById("start-time");
        // 单击查找按钮后进行查票
        function find_ticks(){
            if(startArea.value != "" && endArea.value != "" && startTime.value !=""){
                alert("开始查票！");
                delete_table("tab");
                alert("查找完成！");
                add();
            }
            else{
                alert("输入不能为空！");
            }
        }


        function add_buymsgPanel(index){
            var cells=document.getElementById("tab").rows[index+1].cells;
            document.getElementById("ticket-train-id").innerHTML=cells[0].innerText;
            document.getElementById("s-station").innerHTML=cells[1].getElementsByTagName('p')[0].innerText;
            document.getElementById("e-station").style.background=cells[2].getElementsByTagName('p')[0].innerText;
            document.getElementById("e-time").innerHTML=cells[1].getElementsByTagName('p')[1].innerText;
            document.getElementById("s-time").style.backgroundSize=cells[2].getElementsByTagName('p')[1].innerText;
            
            document.getElementById("money").innerHTML="*";
            ajax_add();//形参arr
        }
        // function seach(arr){
        //     arr.document.getElementsByTagName('p')[0].nodeValue;
        // }

        // ajax异步请求不同座位对应的价格(异步次数较多，每次重选座位类型异步一次)
        function ajax_change_money(money){
            document.getElementById("money").innerHTML=money;
        }

        // 访问以数据库，查询当前 时刻当前车次对应的可选座位类型（每次打开买票面板异步查询一次）arr
        function ajax_add(){
            arr=["无座","一等座","二等座","硬座","商务座"];
            remove_select("seat-type");
           for(i=1;i<arr.length;i++){
            $('#seat-type').append("<option value= " + arr[i] + ">" + arr[i] + "</option>");
           }
        }
        // 清除下拉框的选项
        function remove_select(selectid){
            var div = document.getElementById(selectid); 
            div.innerHTML = '';
        }
        // 为“去购买”的链接写一个事件处理方法,传入选择的列车车次、出发站，目的站、日期，进行异步查询，显示下单信息给用户。
        function click_a(index){
            // train_id,start_area,end_area,start_time
            add_buymsgPanel(index);
            document.querySelector("#pick-message").style.display="block";
        }

        
    </script>
</body>
</html>